{"version":3,"sources":["../src/environment-provider.tsx"],"sourcesContent":["import { useSafeLayoutEffect } from \"@yamada-ui/utils\"\nimport type { FC, ReactNode } from \"react\"\nimport { createContext, useContext, useMemo, useReducer, useRef } from \"react\"\n\nexport type Environment = {\n  getWindow: () => Window | undefined\n  getDocument: () => Document | undefined\n}\n\nconst environment: Environment = {\n  getDocument: () => document,\n  getWindow: () => window,\n}\n\nconst EnvironmentContext = createContext<Environment>(environment)\n\nexport type EnvironmentProviderProps = {\n  children: ReactNode\n  disabled?: boolean\n  environment?: Environment\n}\n\nexport const EnvironmentProvider: FC<EnvironmentProviderProps> = ({\n  children,\n  environment,\n  disabled,\n}) => {\n  const ref = useRef<HTMLSpanElement>(null)\n\n  const context = useMemo<Environment>(() => {\n    if (environment) return environment\n\n    return {\n      getDocument: () => ref.current?.ownerDocument ?? document,\n      getWindow: () => ref.current?.ownerDocument.defaultView ?? window,\n    }\n  }, [environment])\n\n  const enabled = !disabled || !environment\n\n  return (\n    <EnvironmentContext.Provider value={context}>\n      {children}\n\n      {enabled ? <span id=\"__ui_dev\" hidden ref={ref} /> : null}\n    </EnvironmentContext.Provider>\n  )\n}\n\nEnvironmentProvider.displayName = \"EnvironmentProvider\"\n\nexport const useEnvironment = ({ isDefer }: { isDefer?: boolean } = {}) => {\n  const [, forceUpdate] = useReducer((c) => c + 1, 0)\n\n  useSafeLayoutEffect(() => {\n    if (!isDefer) return\n\n    forceUpdate()\n  }, [isDefer])\n\n  return useContext(EnvironmentContext)\n}\n"],"mappings":";;;AAAA,SAAS,2BAA2B;AAEpC,SAAS,eAAe,YAAY,SAAS,YAAY,cAAc;AAuCnE,SAGa,KAHb;AAhCJ,IAAM,cAA2B;AAAA,EAC/B,aAAa,MAAM;AAAA,EACnB,WAAW,MAAM;AACnB;AAEA,IAAM,qBAAqB,cAA2B,WAAW;AAQ1D,IAAM,sBAAoD,CAAC;AAAA,EAChE;AAAA,EACA,aAAAA;AAAA,EACA;AACF,MAAM;AACJ,QAAM,MAAM,OAAwB,IAAI;AAExC,QAAM,UAAU,QAAqB,MAAM;AACzC,QAAIA;AAAa,aAAOA;AAExB,WAAO;AAAA,MACL,aAAa,MAAG;AAjCtB;AAiCyB,+BAAI,YAAJ,mBAAa,kBAAb,YAA8B;AAAA;AAAA,MACjD,WAAW,MAAG;AAlCpB;AAkCuB,+BAAI,YAAJ,mBAAa,cAAc,gBAA3B,YAA0C;AAAA;AAAA,IAC7D;AAAA,EACF,GAAG,CAACA,YAAW,CAAC;AAEhB,QAAM,UAAU,CAAC,YAAY,CAACA;AAE9B,SACE,qBAAC,mBAAmB,UAAnB,EAA4B,OAAO,SACjC;AAAA;AAAA,IAEA,UAAU,oBAAC,UAAK,IAAG,YAAW,QAAM,MAAC,KAAU,IAAK;AAAA,KACvD;AAEJ;AAEA,oBAAoB,cAAc;AAE3B,IAAM,iBAAiB,CAAC,EAAE,QAAQ,IAA2B,CAAC,MAAM;AACzE,QAAM,CAAC,EAAE,WAAW,IAAI,WAAW,CAAC,MAAM,IAAI,GAAG,CAAC;AAElD,sBAAoB,MAAM;AACxB,QAAI,CAAC;AAAS;AAEd,gBAAY;AAAA,EACd,GAAG,CAAC,OAAO,CAAC;AAEZ,SAAO,WAAW,kBAAkB;AACtC;","names":["environment"]}