{"version":3,"sources":["../src/notice-provider.tsx"],"sourcesContent":["import type { CSSUIObject, ThemeConfig } from \"@yamada-ui/core\"\nimport { ui } from \"@yamada-ui/core\"\nimport type { MotionVariants, MotionStyle } from \"@yamada-ui/motion\"\nimport { AnimatePresence, motion, useIsPresent } from \"@yamada-ui/motion\"\nimport { Portal } from \"@yamada-ui/portal\"\nimport { useTimeout } from \"@yamada-ui/use-timeout\"\nimport { cx, runIfFunc, useUpdateEffect } from \"@yamada-ui/utils\"\nimport type { FC } from \"react\"\nimport { memo, useEffect, useState, useSyncExternalStore } from \"react\"\nimport type { NoticeOptions } from \"./notice\"\nimport { noticeStore } from \"./notice\"\n\nexport type NoticeProviderProps = Omit<\n  Required<ThemeConfig>[\"notice\"],\n  \"options\"\n>\n\nexport const NoticeProvider: FC<NoticeProviderProps> = ({\n  variants,\n  gap = \"fallback(4, 1rem)\",\n  appendToParentPortal,\n  containerRef,\n}) => {\n  const state = useSyncExternalStore(\n    noticeStore.subscribe,\n    noticeStore.getSnapshot,\n    noticeStore.getSnapshot,\n  )\n\n  const components = Object.entries(state).map(([placement, notices]) => {\n    const top = placement.includes(\"top\")\n      ? \"env(safe-area-inset-top, 0px)\"\n      : undefined\n    const bottom = placement.includes(\"bottom\")\n      ? \"env(safe-area-inset-bottom, 0px)\"\n      : undefined\n    const right = !placement.includes(\"left\")\n      ? \"env(safe-area-inset-right, 0px)\"\n      : undefined\n    const left = !placement.includes(\"right\")\n      ? \"env(safe-area-inset-left, 0px)\"\n      : undefined\n\n    const css: CSSUIObject = {\n      position: \"fixed\",\n      zIndex: \"fallback(zarbon, 160)\",\n      pointerEvents: \"none\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      margin: gap,\n      gap,\n      top,\n      bottom,\n      right,\n      left,\n    }\n\n    return (\n      <ui.ul\n        key={placement}\n        className={cx(\"ui-notice__list\", `ui-notice__list--${placement}`)}\n        __css={css}\n      >\n        <AnimatePresence initial={false}>\n          {notices.map((notice) => (\n            <NoticeComponent key={notice.id} variants={variants} {...notice} />\n          ))}\n        </AnimatePresence>\n      </ui.ul>\n    )\n  })\n\n  return (\n    <Portal\n      appendToParentPortal={appendToParentPortal}\n      containerRef={containerRef}\n    >\n      {components}\n    </Portal>\n  )\n}\n\nconst defaultVariants: MotionVariants = {\n  initial: ({ placement }) => ({\n    opacity: 0,\n    [[\"top\", \"bottom\"].includes(placement) ? \"y\" : \"x\"]:\n      (placement === \"bottom\" ? 1 : placement.includes(\"right\") ? 1 : -1) * 24,\n  }),\n  animate: {\n    opacity: 1,\n    y: 0,\n    x: 0,\n    scale: 1,\n    transition: {\n      duration: 0.4,\n      ease: [0.4, 0, 0.2, 1],\n    },\n  },\n  exit: {\n    opacity: 0,\n    scale: 0.95,\n    transition: {\n      duration: 0.2,\n      ease: [0.4, 0, 1, 1],\n    },\n  },\n}\n\ntype NoticeComponentProps = NoticeOptions &\n  Pick<NoticeProviderProps, \"variants\">\n\nconst NoticeComponent = memo(\n  ({\n    variants = defaultVariants,\n    placement,\n    duration = 5000,\n    message,\n    onCloseComplete,\n    isDelete = false,\n    onDelete,\n    style,\n  }: NoticeComponentProps) => {\n    const [delay, setDelay] = useState(duration)\n    const isPresent = useIsPresent()\n\n    useUpdateEffect(() => {\n      if (!isPresent) onCloseComplete?.()\n    }, [isPresent])\n\n    useUpdateEffect(() => {\n      setDelay(duration)\n    }, [duration])\n\n    const onMouseEnter = () => setDelay(null)\n    const onMouseLeave = () => setDelay(duration)\n\n    const onClose = () => {\n      if (isPresent) onDelete()\n    }\n\n    useEffect(() => {\n      if (isPresent && isDelete) onDelete()\n    }, [isPresent, isDelete, onDelete])\n\n    useTimeout(onClose, delay)\n\n    const css: CSSUIObject = {\n      pointerEvents: \"auto\",\n      maxW: \"36rem\",\n      minW: \"20rem\",\n      ...style,\n    }\n\n    return (\n      <motion.li\n        layout\n        className=\"ui-notice__list__item\"\n        variants={variants}\n        initial=\"initial\"\n        animate=\"animate\"\n        exit=\"exit\"\n        onHoverStart={onMouseEnter}\n        onHoverEnd={onMouseLeave}\n        custom={{ placement }}\n        style={\n          {\n            display: \"flex\",\n            justifyContent: placement.includes(\"left\")\n              ? \"flex-start\"\n              : placement.includes(\"right\")\n                ? \"flex-end\"\n                : \"center\",\n          } as MotionStyle\n        }\n      >\n        <ui.div className=\"ui-notice__list__item__inner\" __css={css}>\n          {runIfFunc(message, { onClose })}\n        </ui.div>\n      </motion.li>\n    )\n  },\n)\n\nNoticeComponent.displayName = \"NoticeComponent\"\n"],"mappings":"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","names":[]}