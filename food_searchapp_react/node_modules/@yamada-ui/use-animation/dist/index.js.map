{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import type { AnimationStyle, Theme } from \"@yamada-ui/core\"\nimport { useTheme, generateAnimation, css } from \"@yamada-ui/core\"\nimport { useBoolean } from \"@yamada-ui/use-boolean\"\nimport { useEventListener } from \"@yamada-ui/use-event-listener\"\nimport {\n  isArray,\n  isUndefined,\n  runIfFunc,\n  getOwnerWindow,\n} from \"@yamada-ui/utils\"\nimport { useCallback, useEffect, useRef, useState } from \"react\"\n\ntype Styles =\n  | AnimationStyle\n  | Theme[\"animations\"]\n  | (AnimationStyle | Theme[\"animations\"])[]\n\n/**\n * `useAnimation` is a custom hook that implements animations similar to CSS `keyframes`.\n *\n * @see Docs https://yamada-ui.com/hooks/use-animation\n */\nexport const useAnimation = (styles: Styles): string => {\n  const { theme } = useTheme()\n\n  if (isArray(styles)) {\n    return styles\n      .map((style) => generateAnimation(style, theme, css))\n      .join(\", \")\n  } else {\n    return generateAnimation(styles, theme, css)\n  }\n}\n\n/**\n * `useDynamicAnimation` is a custom hook used to switch animations.\n *\n * @see Docs https://yamada-ui.com/hooks/use-dynamic-animation\n */\nexport const useDynamicAnimation = <\n  T extends (AnimationStyle | Theme[\"animations\"])[] | Record<string, Styles>,\n>(\n  arrayOrObj: T,\n  init?: keyof T | (keyof T)[],\n): [\n  string | undefined,\n  (\n    key:\n      | keyof T\n      | (keyof T)[]\n      | ((key: keyof T | (keyof T)[] | undefined) => keyof T | (keyof T)[]),\n  ) => void,\n] => {\n  const { theme } = useTheme()\n\n  const keys = useRef<string | string[] | undefined>(\n    !isUndefined(init)\n      ? isArray(init)\n        ? init.map(String)\n        : String(init)\n      : undefined,\n  )\n  const cache = useRef<Map<string, string>>(new Map<string, string>())\n\n  const [animations, setAnimations] = useState<string | undefined>(() => {\n    for (const [key, styles] of Object.entries(arrayOrObj)) {\n      if (cache.current.has(key)) return\n\n      if (isArray(styles)) {\n        cache.current.set(\n          key,\n          styles\n            .map((style) => generateAnimation(style, theme, css))\n            .join(\", \"),\n        )\n      } else {\n        cache.current.set(key, generateAnimation(styles, theme, css))\n      }\n    }\n\n    if (isArray(keys.current)) {\n      return keys.current.map((key) => cache.current.get(key)).join(\", \")\n    } else {\n      return cache.current.get(keys.current ?? \"\")\n    }\n  })\n\n  const setAnimation = useCallback(\n    (\n      keysOrFunc:\n        | keyof T\n        | (keyof T)[]\n        | ((key: keyof T | (keyof T)[] | undefined) => keyof T | (keyof T)[]),\n    ) => {\n      const args = (() => {\n        if (!isUndefined(keys.current) && isArray(arrayOrObj)) {\n          return isArray(keys.current)\n            ? keys.current.map(Number)\n            : Number(keys.current)\n        } else {\n          return keys.current\n        }\n      })() as keyof T | (keyof T)[] | undefined\n\n      const keyOrArray = runIfFunc(keysOrFunc, args)\n\n      keys.current = isArray(keyOrArray)\n        ? keyOrArray.map(String)\n        : String(keyOrArray)\n\n      if (isArray(keys.current)) {\n        setAnimations(\n          keys.current.map((key) => cache.current.get(key)).join(\", \"),\n        )\n      } else {\n        setAnimations(cache.current.get(keys.current ?? \"\"))\n      }\n    },\n    [arrayOrObj],\n  )\n\n  return [animations, setAnimation]\n}\n\nexport type UseAnimationObserverProps = {\n  isOpen: boolean\n  ref: React.RefObject<HTMLElement>\n}\n\nexport const useAnimationObserver = ({\n  isOpen,\n  ref,\n}: UseAnimationObserverProps) => {\n  const [mounted, setMounted] = useState(isOpen)\n  const [flg, { on }] = useBoolean()\n\n  useEffect(() => {\n    if (flg) return\n\n    setMounted(isOpen)\n    on()\n  }, [isOpen, flg, on])\n\n  useEventListener(\n    () => ref.current,\n    \"animationend\",\n    () => setMounted(isOpen),\n  )\n\n  const hidden = isOpen ? false : !mounted\n\n  return {\n    present: !hidden,\n    onAnimationComplete() {\n      const ownerWindow = getOwnerWindow(ref.current)\n      const ev = new ownerWindow.CustomEvent(\"animationend\", {\n        bubbles: true,\n      })\n\n      ref.current?.dispatchEvent(ev)\n    },\n  }\n}\n\nexport type ReturnUseAnimationObserver = ReturnType<typeof useAnimationObserver>\n"],"mappings":"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","names":[]}